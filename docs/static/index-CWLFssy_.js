import{_ as C,C as $,d as M,u as F,a as N,r as c,v as A,w as D,y as B,e as V,c as p,f as e,A as x,m as L,F as P,D as T,h as u,H as I,I as R,K as j,s as z,t as E,o as h,k as H}from"./index-CqU5sET7.js";import{l as K}from"./products-PxzrFPp4.js";import{g as O,u as G,a as J}from"./reviewsUser-Db4yIioF.js";const o=g=>(z("data-v-ceee88eb"),g=g(),E(),g),W={class:"review-container"},X={class:"page-title"},Y=o(()=>e("h1",null,"评价订单",-1)),Z={class:"order-info"},Q={class:"order-info"},ee={key:0},te={class:"rating-section"},le=o(()=>e("h2",null,"请为您的体验评分",-1)),ae={class:"rating-item"},se=o(()=>e("label",null,"总体评分",-1)),oe={class:"rating-grid"},ne={class:"rating-item"},ue=o(()=>e("label",null,"服务评分",-1)),ie={class:"rating-item"},de=o(()=>e("label",null,"行程安排",-1)),re={class:"rating-item"},ce=o(()=>e("label",null,"住宿评分",-1)),ve={class:"rating-item"},me=o(()=>e("label",null,"餐饮评分",-1)),_e={class:"rating-item"},ge=o(()=>e("label",null,"交通评分",-1)),pe={class:"rating-item"},he=o(()=>e("label",null,"导游评分",-1)),be={class:"rating-item"},xe=o(()=>e("label",null,"性价比",-1)),Ie={class:"image-upload"},fe=o(()=>e("label",null,"上传图片（可选）",-1)),Ve={class:"review-content"},Re=o(()=>e("h2",null,"评价内容",-1)),we={class:"input-item"},ye=o(()=>e("label",{for:"title"},"评价标题",-1)),Ue={class:"input-item"},ke=o(()=>e("label",{for:"content"},"评价详情",-1)),qe={class:"word-count"},Se={class:"anonymous-option"},Ce={class:"checkbox-label"},$e=o(()=>e("span",null,"匿名评价",-1)),Me=o(()=>e("p",{class:"hint-text"},"匿名评价将不会显示您的用户名",-1)),Fe={class:"submit-section"},Ne=["disabled"],Ae=$({name:"commnet"}),De=Object.assign(Ae,{setup(g){const{proxy:r}=M(),n=F(),b=N(),v=c(null),_=c(null),m=c(null),f=c([]),i=c(["😡生气","😞失望","😐一般","😊不错","🥰满意"]);function w(){K({pageNum:1,pageSize:1e4}).then(s=>{f.value=s.rows})}const t=c({userId:null,reviewId:null,productId:null,orderId:null,status:null,title:"",content:"",overallRating:null,serviceRating:null,itineraryRating:null,accommodationRating:null,foodRating:null,transportationRating:null,guideRating:null,valueForMoneyRating:null,imageUrls:"",isAnonymous:0});A(()=>{w(),n.query.productId&&(v.value=n.query.productId,t.value.productId=v.value),n.query.userId&&(_.value=n.query.userId,t.value.userId=_.value),n.query.orderId&&(m.value=n.query.orderId,t.value.orderId=m.value),n.query.reviewId&&y(n.query.reviewId)}),D(()=>n.query,s=>{s.productId&&s.productId!==v.value&&(v.value=s.productId,t.value.productId=v.value),s.userId&&s.userId!==_.value&&(_.value=s.userId,t.value.userId=_.value),s.orderId&&s.orderId!==m.value&&(m.value=s.orderId,t.value.orderId=m.value)});function y(s){O(s).then(l=>{t.value=l.data})}const U=B(()=>t.value.overallRating!==null&&t.value.title.trim()!==""&&t.value.content.trim()!==""),k=async()=>{try{const s=c("评价成功");t.value.status!==null&&t.value.status!==1&&(t.value.status=0,s.value="评价已提交，请耐心等待审核"),t.value.reviewId?G(t.value).then(l=>{l.code===200?(r.$message.success(s.value),b.back()):r.$message.error("修改评价失败："+(l.msg||"未知错误"))}).catch(l=>{r.$message.error("评价出错："+l.message)}):J(t.value).then(l=>{l.code===200?(r.$message.success(s.value),b.back()):r.$message.error("评价失败："+(l.msg||"未知错误"))}).catch(l=>{r.$message.error("评价出错："+l.message)})}catch(s){r.$message.error("评价提交失败，请稍后重试"),console.error("提交评价错误:",s)}},q=()=>{confirm("确定要取消评价吗？已填写的内容将不会保存。")&&b.back()};return(s,l)=>{const d=V("el-rate"),S=V("image-upload");return h(),p("div",W,[e("div",X,[Y,e("p",Z,"订单号: "+x(m.value),1),e("p",Q,[L("产品名称: "),(h(!0),p(P,null,T(f.value,a=>(h(),p("span",{key:a.productId},[String(a.productId)===String(v.value)?(h(),p("span",ee,x(a.title),1)):H("",!0)]))),128))])]),e("div",te,[le,e("div",ae,[se,u(d,{modelValue:t.value.overallRating,"onUpdate:modelValue":l[0]||(l[0]=a=>t.value.overallRating=a),texts:i.value,"show-text":"",clearable:""},null,8,["modelValue","texts"])]),e("div",oe,[e("div",ne,[ue,u(d,{modelValue:t.value.serviceRating,"onUpdate:modelValue":l[1]||(l[1]=a=>t.value.serviceRating=a),texts:i.value,"show-text":"",clearable:""},null,8,["modelValue","texts"])]),e("div",ie,[de,u(d,{modelValue:t.value.itineraryRating,"onUpdate:modelValue":l[2]||(l[2]=a=>t.value.itineraryRating=a),texts:i.value,"show-text":"",clearable:""},null,8,["modelValue","texts"])]),e("div",re,[ce,u(d,{modelValue:t.value.accommodationRating,"onUpdate:modelValue":l[3]||(l[3]=a=>t.value.accommodationRating=a),texts:i.value,"show-text":"",clearable:""},null,8,["modelValue","texts"])]),e("div",ve,[me,u(d,{modelValue:t.value.foodRating,"onUpdate:modelValue":l[4]||(l[4]=a=>t.value.foodRating=a),texts:i.value,"show-text":"",clearable:""},null,8,["modelValue","texts"])]),e("div",_e,[ge,u(d,{modelValue:t.value.transportationRating,"onUpdate:modelValue":l[5]||(l[5]=a=>t.value.transportationRating=a),texts:i.value,"show-text":"",clearable:""},null,8,["modelValue","texts"])]),e("div",pe,[he,u(d,{modelValue:t.value.guideRating,"onUpdate:modelValue":l[6]||(l[6]=a=>t.value.guideRating=a),texts:i.value,"show-text":"",clearable:""},null,8,["modelValue","texts"])]),e("div",be,[xe,u(d,{modelValue:t.value.valueForMoneyRating,"onUpdate:modelValue":l[7]||(l[7]=a=>t.value.valueForMoneyRating=a),texts:i.value,"show-text":"",clearable:""},null,8,["modelValue","texts"])])])]),e("div",Ie,[fe,u(S,{modelValue:t.value.imageUrls,"onUpdate:modelValue":l[8]||(l[8]=a=>t.value.imageUrls=a),multiple:""},null,8,["modelValue"])]),e("div",Ve,[Re,e("div",we,[ye,I(e("input",{type:"text",id:"title","onUpdate:modelValue":l[9]||(l[9]=a=>t.value.title=a),placeholder:"请输入评价标题（如：非常满意的旅行体验）",maxlength:"50"},null,512),[[R,t.value.title]])]),e("div",Ue,[ke,I(e("textarea",{id:"content","onUpdate:modelValue":l[10]||(l[10]=a=>t.value.content=a),placeholder:"请分享您的详细体验...（如行程亮点、服务感受等）",rows:"6",maxlength:"500"},null,512),[[R,t.value.content]]),e("p",qe,x(t.value.content.length)+"/500",1)]),e("div",Se,[e("label",Ce,[I(e("input",{type:"checkbox","onUpdate:modelValue":l[11]||(l[11]=a=>t.value.isAnonymous=a),"true-value":"1","false-value":"0"},null,512),[[j,t.value.isAnonymous]]),$e]),Me])]),e("div",Fe,[e("button",{class:"submit-btn",onClick:k,disabled:!U.value}," 提交评价 ",8,Ne),e("button",{class:"cancel-btn",onClick:q},"取消")])])}}}),Te=C(De,[["__scopeId","data-v-ceee88eb"]]);export{Te as default};
