import{_ as B,C as V,d as j,a as E,b as O,r as p,y as P,v as T,c as e,o as a,f as s,k as v,F as o,D as d,G as _,A as r,m as w,n as q,s as G,t as H}from"./index-CqU5sET7.js";import{l as J,g as K,u as Q}from"./reviewsUser-Db4yIioF.js";import{l as W}from"./products-PxzrFPp4.js";const i=h=>(G("data-v-a7bcf10c"),h=h(),H(),h),X={class:"review-page"},Y=i(()=>s("div",{class:"page-header"},[s("h1",null,"我的评价")],-1)),Z={class:"status-filter"},ss=["onClick"],ts={class:"reviews-container"},es={key:0,class:"empty-state"},as=i(()=>s("img",{src:"https://picsum.photos/id/20/100/100",alt:"暂无评价",class:"empty-img"},null,-1)),ns=i(()=>s("p",null,"暂无符合条件的评价",-1)),ls=[as,ns],os={key:1,class:"reviews-list"},is={class:"review-header"},cs={class:"review-date"},rs={class:"review-title"},ds={class:"rating stars-{{ review.overallRating }}"},us={class:"rating-text"},_s={class:"review-content"},vs={key:0,class:"review-images"},ps=["src","alt"],hs={class:"review-actions"},gs={class:"like-count"},ms=i(()=>s("i",{class:"icon-like"},null,-1)),ys=["onClick"],fs={class:"modal-header"},ks=i(()=>s("h2",null,"评价详情",-1)),Rs={key:0,class:"modal-body"},ws={class:"detail-section"},bs={class:"rating stars-{{ currentReview.overallRating }}"},Cs={class:"rating-text"},Is={class:"detail-date"},Ss={key:0,class:"anonymous-tag"},Ds={class:"detail-section scores-section"},Ms=i(()=>s("h4",null,"分项评分",-1)),Us={class:"score-item"},$s=i(()=>s("span",null,"服务评分：",-1)),Ls={class:"rating inline-stars stars-{{ currentReview.serviceRating }}"},Ns={class:"score-item"},xs=i(()=>s("span",null,"行程安排：",-1)),As={class:"rating inline-stars stars-{{ currentReview.itineraryRating }}"},zs={class:"score-item"},Fs=i(()=>s("span",null,"住宿评分：",-1)),Bs={class:"rating inline-stars stars-{{ currentReview.accommodationRating }}"},Vs={class:"score-item"},js=i(()=>s("span",null,"餐饮评分：",-1)),Es={class:"rating inline-stars stars-{{ currentReview.foodRating }}"},Os={class:"score-item"},Ps=i(()=>s("span",null,"交通评分：",-1)),Ts={class:"rating inline-stars stars-{{ currentReview.transportationRating }}"},qs={class:"score-item"},Gs=i(()=>s("span",null,"导游评分：",-1)),Hs={class:"rating inline-stars stars-{{ currentReview.guideRating }}"},Js={class:"score-item"},Ks=i(()=>s("span",null,"性价比：",-1)),Qs={class:"rating inline-stars stars-{{ currentReview.valueForMoneyRating }}"},Ws={class:"detail-section"},Xs=i(()=>s("h4",null,"评价内容",-1)),Ys={class:"full-content"},Zs={key:0,class:"detail-section images-section"},st=i(()=>s("h4",null,"评价图片",-1)),tt={class:"image-grid"},et=["src","alt"],at={key:1,class:"detail-section reply-section"},nt=i(()=>s("h4",null,"商家回复",-1)),lt={class:"reply-content"},ot={class:"reply-time"},it={class:"detail-section order-info"},ct={key:0},rt={class:"modal-footer"},dt=V({name:"myReview"}),ut=Object.assign(dt,{setup(h){const{proxy:b}=j(),$=E(),C=O().id,y=p([]),I=[{label:"全部评价",value:-1},{label:"待审核",value:0},{label:"审核通过",value:1},{label:"审核驳回",value:2},{label:"已删除",value:3}],g=p(-1),f=p(!1),n=p(null);function S(){J({userId:C,pageNum:1,pageSize:1e4}).then(l=>{y.value=l.rows})}const D=P(()=>g.value===-1?y.value:y.value.filter(l=>l.status===g.value));function L(l){g.value=I[l].value}function N(l){return{0:"待审核",1:"审核通过",2:"审核驳回",3:"已删除"}[l]||"未知状态"}function x(l){return{0:"status-pending",1:"status-approved",2:"status-rejected",3:"status-deleted"}[l]||"status-default"}function k(l){return l?new Date(l).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):""}function A(l){K(l.reviewId).then(c=>{n.value=c.data,f.value=!0,document.body.style.overflow="hidden"})}function m(){f.value=!1,n.value=null,document.body.style.overflow=""}function M(){$.push({path:"/comment",query:{reviewId:n.value.reviewId,productId:n.value.productId,userId:C,orderId:n.value.orderId}}),m()}function z(l){confirm("确定要删除这条评价吗？")&&(l.status=3,Q(l).then(c=>{c.code===200?(b.$message.success("评价已删除"),m(),S()):b.$message.error("删除失败")}))}const U=p([]);function F(){W({pageNum:1,pageSize:1e4}).then(l=>{U.value=l.rows})}return T(()=>{S(),F()}),(l,c)=>(a(),e("div",X,[Y,s("div",Z,[(a(),e(o,null,d(I,(t,u)=>s("button",{key:u,onClick:R=>L(u),class:_({active:g.value===u-1})},r(t.label),11,ss)),64))]),s("div",ts,[D.value.length===0?(a(),e("div",es,ls)):(a(),e("div",os,[(a(!0),e(o,null,d(D.value,t=>(a(),e("div",{class:"review-card",key:t.reviewId},[s("div",is,[s("div",{class:_(["review-status",x(t.status)])},r(N(t.status)),3),s("div",cs,r(k(t.createdAt)),1)]),s("div",rs,[s("h3",null,r(t.title),1),s("div",ds,[(a(),e(o,null,d(5,u=>s("span",{key:u,class:_(["star",{filled:u<=t.overallRating}])},"★",2)),64)),s("span",us,r(t.overallRating)+"分",1)])]),s("div",_s,[s("p",null,r(t.content.length>100?t.content.substring(0,100)+"...":t.content),1)]),t.imageUrls?(a(),e("div",vs,[(a(!0),e(o,null,d(t.imageUrls.split(","),(u,R)=>(a(),e("div",{class:"image-preview",key:R},[s("img",{src:u,alt:"评价图片"+(R+1)},null,8,ps)]))),128))])):v("",!0),s("div",hs,[s("span",gs,[ms,w(" 有用 "+r(t.likeCount),1)]),s("button",{class:"view-detail",onClick:u=>A(t)},"查看详情",8,ys)])]))),128))]))]),f.value?(a(),e("div",{key:0,class:"modal-backdrop",onClick:c[3]||(c[3]=t=>m())},[s("div",{class:"modal",onClick:c[2]||(c[2]=q(()=>{},["stop"]))},[s("div",fs,[ks,s("button",{class:"close-btn",onClick:c[0]||(c[0]=t=>m())},"×")]),n.value?(a(),e("div",Rs,[s("div",ws,[s("h3",null,r(n.value.title),1),s("div",bs,[(a(),e(o,null,d(5,t=>s("span",{key:t,class:_(["star",{filled:t<=n.value.overallRating}])},"★",2)),64)),s("span",Cs,r(n.value.overallRating)+"分 (总体评分)",1)]),s("p",Is,[w(r(k(n.value.createdAt))+" ",1),n.value.isAnonymous===1?(a(),e("span",Ss,"匿名评价")):v("",!0)])]),s("div",Ds,[Ms,s("div",Us,[$s,s("div",Ls,[(a(),e(o,null,d(5,t=>s("span",{key:"s"+t,class:_(["star",{filled:t<=n.value.serviceRating}])},"★",2)),64))])]),s("div",Ns,[xs,s("div",As,[(a(),e(o,null,d(5,t=>s("span",{key:"i"+t,class:_(["star",{filled:t<=n.value.itineraryRating}])},"★",2)),64))])]),s("div",zs,[Fs,s("div",Bs,[(a(),e(o,null,d(5,t=>s("span",{key:"a"+t,class:_(["star",{filled:t<=n.value.accommodationRating}])},"★",2)),64))])]),s("div",Vs,[js,s("div",Es,[(a(),e(o,null,d(5,t=>s("span",{key:"f"+t,class:_(["star",{filled:t<=n.value.foodRating}])},"★",2)),64))])]),s("div",Os,[Ps,s("div",Ts,[(a(),e(o,null,d(5,t=>s("span",{key:"t"+t,class:_(["star",{filled:t<=n.value.transportationRating}])},"★",2)),64))])]),s("div",qs,[Gs,s("div",Hs,[(a(),e(o,null,d(5,t=>s("span",{key:"g"+t,class:_(["star",{filled:t<=n.value.guideRating}])},"★",2)),64))])]),s("div",Js,[Ks,s("div",Qs,[(a(),e(o,null,d(5,t=>s("span",{key:"v"+t,class:_(["star",{filled:t<=n.value.valueForMoneyRating}])},"★",2)),64))])])]),s("div",Ws,[Xs,s("p",Ys,r(n.value.content),1)]),n.value.imageUrls?(a(),e("div",Zs,[st,s("div",tt,[(a(!0),e(o,null,d(n.value.imageUrls.split(","),(t,u)=>(a(),e("img",{key:"img"+u,src:t,alt:"评价图片"+(u+1),class:"detail-image"},null,8,et))),128))])])):v("",!0),n.value.replyContent?(a(),e("div",at,[nt,s("div",lt,[s("p",null,r(n.value.replyContent),1),s("p",ot,r(k(n.value.repliedAt)),1)])])):v("",!0),s("div",it,[s("p",null,"订单编号："+r(n.value.orderId),1),s("p",null,[w("产品ID: "),(a(!0),e(o,null,d(U.value,t=>(a(),e("span",{key:t.productId},[t.productId===n.value.productId?(a(),e("span",ct,r(t.title),1)):v("",!0)]))),128))])])])):v("",!0),s("div",rt,[n.value?(a(),e(o,{key:0},[n.value.status===3?(a(),e("button",{key:0,class:"btn primary",onClick:M},"重新发布")):(a(),e(o,{key:1},[s("button",{class:"btn secondary",onClick:c[1]||(c[1]=t=>z(n.value))},"删除评论"),s("button",{class:"btn primary",onClick:M},"重新编辑")],64))],64)):v("",!0)])])])):v("",!0)]))}}),gt=B(ut,[["__scopeId","data-v-a7bcf10c"]]);export{gt as default};
