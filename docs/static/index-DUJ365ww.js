import{_ as V,C as T,d as E,a as B,b as D,r as c,y as O,v as q,w as A,c as i,o as l,f as s,k as r,A as u,H as p,I as _,F as C,D as z,G as F,s as J,t as R}from"./index-CqU5sET7.js";import{g as j,a as G,u as H}from"./profilesManage-wgDOMe7j.js";import{l as L}from"./couponsUserManage-CmrF8zlg.js";const a=f=>(J("data-v-22c26eba"),f=f(),R(),f),K={class:"profile-container"},Q={class:"top-nav"},W=a(()=>s("div",{class:"nav-title"},"我的信息",-1)),X={class:"profile-card"},Y={class:"profile-details"},Z={class:"detail-item"},ss=a(()=>s("span",{class:"label"},"真实姓名",-1)),es={key:1},ts={class:"detail-item"},as=a(()=>s("span",{class:"label"},"出生日期",-1)),os={key:1},ns={class:"detail-item"},is=a(()=>s("span",{class:"label"},"护照号码",-1)),ls={key:1},us={class:"detail-item"},ds=a(()=>s("span",{class:"label"},"护照有效期",-1)),cs={key:1},rs={class:"detail-item"},ps=a(()=>s("span",{class:"label"},"紧急联系人",-1)),_s={key:1},vs={class:"detail-item"},ms=a(()=>s("span",{class:"label"},"紧急联系电话",-1)),hs={key:1},fs={class:"function-menu"},ys=a(()=>s("i",{class:"icon"},"✈️",-1)),gs=a(()=>s("span",null,"我的游记",-1)),ks=a(()=>s("i",{class:"arrow"},"→",-1)),bs=[ys,gs,ks],Cs=a(()=>s("i",{class:"icon"},"⭐",-1)),xs=a(()=>s("span",null,"我的评价",-1)),ws=a(()=>s("i",{class:"arrow"},"→",-1)),Ps=[Cs,xs,ws],Ns=a(()=>s("i",{class:"icon"},"🎫",-1)),Ss=a(()=>s("span",null,"我的优惠券",-1)),Is=a(()=>s("i",{class:"arrow"},"→",-1)),Ms=[Ns,Ss,Is],Us=a(()=>s("i",{class:"icon"},"🛰️",-1)),$s=a(()=>s("span",null,"我的订单",-1)),Vs=a(()=>s("i",{class:"arrow"},"→",-1)),Ts=[Us,$s,Vs],Es=a(()=>s("i",{class:"icon"},"ℹ️",-1)),Bs=a(()=>s("span",null,"基础资料",-1)),Ds=a(()=>s("i",{class:"arrow"},"→",-1)),Os=[Es,Bs,Ds],qs={key:0,class:"coupon-modal"},As={class:"modal-content"},zs={class:"modal-header"},Fs=a(()=>s("h3",null,"我的优惠券",-1)),Js={class:"coupon-list"},Rs={key:0,class:"empty-coupon"},js={class:"coupon-info"},Gs={class:"coupon-id"},Hs={class:"coupon-status"},Ls={class:"coupon-date"},Ks={key:2},Qs=["onClick"],Ws=T({name:"myProfiles"}),Xs=Object.assign(Ws,{setup(f){const{proxy:x}=E(),v=B(),m=D().id,h=c({}),k=c([]),d=c(!1),y=c(!1),b=c({}),n=O({get:()=>({userId:m,...h.value}),set:o=>{h.value=o}});function w(){j(m).then(o=>{h.value=o.data||{},b.value=JSON.parse(JSON.stringify({userId:m,...h.value}))})}function P(){L({pageNum:1,pageSize:1e3,userId:m}).then(o=>{k.value=o.rows||[]})}function g(o){o==="travels"&&v.push("/myUser/myTravelNote"),o==="reviews"&&v.push("/myUser/myReview"),o==="basic-info"&&v.push("/user/profile"),o==="orders"&&v.push("/myUser/myOrders")}function N(o){return{0:"未使用",1:"已使用",2:"已过期"}[o]||"未知状态"}function S(o){return{0:"status-unused",1:"status-used",2:"status-expired"}[o]||""}function I(o){v.push("/userProduct/userProducts"),y.value=!1}function M(){d.value?U():d.value=!0}function U(){const o=!h.value.profileId,t={...n.value,userId:m};(o?G(t):H(t)).then(()=>{x.$message.success(o?"资料新增成功":"资料更新成功"),d.value=!1,w()}).catch(()=>{x.$message.error(o?"资料新增失败":"资料更新失败"),n.value=b.value})}q(()=>{w(),P()}),A(d,(o,t)=>{o===!1&&t===!0&&($.value||(n.value=b.value))});const $=c(!1);return(o,t)=>(l(),i("div",K,[s("nav",Q,[W,s("button",{class:"edit-btn",onClick:M},u(d.value?"保存":"编辑"),1)]),s("div",X,[s("div",Y,[s("div",Z,[ss,d.value?p((l(),i("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value.realName=e),class:"edit-input",type:"text"},null,512)),[[_,n.value.realName]]):(l(),i("span",es,u(n.value.realName||"未设置"),1))]),s("div",ts,[as,d.value?p((l(),i("input",{key:0,"onUpdate:modelValue":t[1]||(t[1]=e=>n.value.birthdate=e),class:"edit-input",type:"date"},null,512)),[[_,n.value.birthdate]]):(l(),i("span",os,u(n.value.birthdate||"未设置"),1))]),s("div",ns,[is,d.value?p((l(),i("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=e=>n.value.passportNumber=e),class:"edit-input",type:"text"},null,512)),[[_,n.value.passportNumber]]):(l(),i("span",ls,u(n.value.passportNumber||"未设置"),1))]),s("div",us,[ds,d.value?p((l(),i("input",{key:0,"onUpdate:modelValue":t[3]||(t[3]=e=>n.value.passportExpiry=e),class:"edit-input",type:"date"},null,512)),[[_,n.value.passportExpiry]]):(l(),i("span",cs,u(n.value.passportExpiry||"未设置"),1))]),s("div",rs,[ps,d.value?p((l(),i("input",{key:0,"onUpdate:modelValue":t[4]||(t[4]=e=>n.value.emergencyContact=e),class:"edit-input",type:"text"},null,512)),[[_,n.value.emergencyContact]]):(l(),i("span",_s,u(n.value.emergencyContact||"未设置"),1))]),s("div",vs,[ms,d.value?p((l(),i("input",{key:0,"onUpdate:modelValue":t[5]||(t[5]=e=>n.value.emergencyPhone=e),class:"edit-input",type:"tel"},null,512)),[[_,n.value.emergencyPhone]]):(l(),i("span",hs,u(n.value.emergencyPhone||"未设置"),1))])])]),s("div",fs,[s("div",{class:"menu-item",onClick:t[6]||(t[6]=e=>g("travels"))},bs),s("div",{class:"menu-item",onClick:t[7]||(t[7]=e=>g("reviews"))},Ps),s("div",{class:"menu-item",onClick:t[8]||(t[8]=e=>y.value=!0)},Ms),s("div",{class:"menu-item",onClick:t[9]||(t[9]=e=>g("orders"))},Ts),s("div",{class:"menu-item",onClick:t[10]||(t[10]=e=>g("basic-info"))},Os)]),y.value?(l(),i("div",qs,[s("div",As,[s("div",zs,[Fs,s("button",{class:"close-btn",onClick:t[11]||(t[11]=e=>y.value=!1)},"×")]),s("div",Js,[k.value.length===0?(l(),i("div",Rs," 暂无优惠券 ")):r("",!0),(l(!0),i(C,null,z(k.value,e=>(l(),i("div",{key:e.id,class:"coupon-card"},[s("div",js,[s("div",Gs,"券码: "+u(e.code),1),s("div",Hs,[s("span",{class:F(S(e.status))},u(N(e.status)),3)]),s("div",Ls,[e.status===0?(l(),i(C,{key:0},[s("span",null,"领取日期: "+u(e.acquiredAt),1),s("span",null,"过期日期: "+u(e.expirationTime),1)],64)):r("",!0),e.status===1?(l(),i(C,{key:1},[s("span",null,"订单号: "+u(e.orderId||"未知"),1),s("span",null,"使用日期: "+u(e.usedAt),1)],64)):r("",!0),e.status===2?(l(),i("span",Ks,"过期时间: "+u(e.expirationTime),1)):r("",!0)])]),e.status===0?(l(),i("button",{key:0,class:"use-btn",onClick:Zs=>I()}," 去使用 ",8,Qs)):r("",!0)]))),128))])])])):r("",!0)]))}}),ae=V(Xs,[["__scopeId","data-v-22c26eba"]]);export{ae as default};
