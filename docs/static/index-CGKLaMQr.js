import{_ as at}from"./empty-ByoyfXbv.js";import{_ as ot,C as lt,d as nt,a as ct,b as it,r as _,y as dt,v as ut,w as rt,e as M,c as i,o as c,f as t,h,F as m,D as y,G as R,A as a,k as r,m as f,i as v,j as _t,c7 as u,s as vt,t as ht}from"./index-Lq3EucIc.js";import{l as pt,c as mt,b as ft,d as bt,e as yt,f as kt,g as gt}from"./userOrders-BIeY2I1m.js";import{g as Ct}from"./manageOrders-DjJZIfBR.js";import{l as It}from"./products-CBA54OiK.js";import{g as St}from"./productInventory-BN_jAqQY.js";const o=V=>(vt("data-v-74102741"),V=V(),ht(),V),wt={class:"order-container"},Vt=o(()=>t("div",{class:"page-title"},"我的订单",-1)),Ot={class:"status-filter"},xt=["onClick"],$t={class:"order-list"},Mt={key:0,class:"empty-state"},Ut=o(()=>t("img",{src:at,alt:"暂无订单",class:"empty-img"},null,-1)),At=o(()=>t("p",{class:"empty-text"},"暂无符合条件的订单",-1)),Nt=[Ut,At],Rt={class:"order-header"},Tt={class:"order-id"},Dt={class:"order-info"},Pt={class:"product-info"},Lt={class:"product-name"},Bt={key:0},Et={class:"travel-date"},zt={class:"travelers"},Ft={class:"contact-info"},jt={class:"contact-name"},qt={class:"contact-phone"},Gt={class:"order-amount"},Ht={class:"amount-item"},Jt=o(()=>t("span",null,"总价",-1)),Kt={class:"amount-item"},Qt=o(()=>t("span",null,"优惠",-1)),Wt={class:"amount-item total"},Xt=o(()=>t("span",null,"实付",-1)),Yt={class:"order-actions"},Zt=["onClick"],te=["onClick"],ee=["onClick"],se=["onClick"],ae=["onClick"],oe=["onClick"],le=["onClick"],ne=["onClick"],ce=["onClick"],ie=["onClick"],de={key:0,class:"detail-section"},ue=o(()=>t("h3",null,"可选出发日期",-1)),re={class:"departure-date-list"},_e={key:0,class:"order-detail-content"},ve={class:"detail-section"},he=o(()=>t("h3",null,"基本信息",-1)),pe={class:"detail-grid"},me={class:"detail-item"},fe=o(()=>t("span",{class:"label"},"订单号:",-1)),be={class:"value"},ye={class:"detail-item"},ke=o(()=>t("span",{class:"label"},"下单时间:",-1)),ge={class:"value"},Ce={class:"detail-item"},Ie=o(()=>t("span",{class:"label"},"订单状态:",-1)),Se={class:"detail-item"},we=o(()=>t("span",{class:"label"},"出发日期:",-1)),Ve={class:"value"},Oe={class:"detail-section"},xe=o(()=>t("h3",null,"产品信息",-1)),$e={class:"detail-grid"},Me={class:"detail-item full-width"},Ue=o(()=>t("span",{class:"label"},"产品名称:",-1)),Ae={class:"value"},Ne={key:0},Re={class:"detail-item"},Te=o(()=>t("span",{class:"label"},"成人数量:",-1)),De={class:"value"},Pe={class:"detail-item"},Le=o(()=>t("span",{class:"label"},"儿童数量:",-1)),Be={class:"value"},Ee={class:"detail-section"},ze=o(()=>t("h3",null,"联系人信息",-1)),Fe={class:"detail-grid"},je={class:"detail-item"},qe=o(()=>t("span",{class:"label"},"联系人:",-1)),Ge={class:"value"},He={class:"detail-item"},Je=o(()=>t("span",{class:"label"},"联系电话:",-1)),Ke={class:"value"},Qe={class:"detail-item full-width"},We=o(()=>t("span",{class:"label"},"联系邮箱:",-1)),Xe={class:"value"},Ye={key:0,class:"detail-section"},Ze=o(()=>t("h3",null,"出行人信息",-1)),ts={class:"traveler-list"},es={class:"traveler-header"},ss={class:"detail-grid"},as={class:"detail-item"},os=o(()=>t("span",{class:"label"},"姓名:",-1)),ls={class:"value"},ns={class:"detail-item"},cs=o(()=>t("span",{class:"label"},"性别:",-1)),is={class:"value"},ds={class:"detail-item"},us=o(()=>t("span",{class:"label"},"生日:",-1)),rs={class:"value"},_s={class:"detail-item"},vs=o(()=>t("span",{class:"label"},"护照号:",-1)),hs={class:"value"},ps={class:"detail-item full-width"},ms=o(()=>t("span",{class:"label"},"护照有效期:",-1)),fs={class:"value"},bs={key:1,class:"detail-section"},ys=o(()=>t("h3",null,"支付信息",-1)),ks={class:"detail-grid"},gs={class:"detail-item"},Cs=o(()=>t("span",{class:"label"},"支付方式:",-1)),Is={class:"value"},Ss={class:"detail-item"},ws=o(()=>t("span",{class:"label"},"支付状态:",-1)),Vs={class:"value"},Os={class:"detail-item"},xs=o(()=>t("span",{class:"label"},"支付时间:",-1)),$s={class:"value"},Ms={class:"detail-item full-width amount-info"},Us={class:"amount-row"},As=o(()=>t("span",null,"总金额:",-1)),Ns={class:"amount-row"},Rs=o(()=>t("span",null,"优惠金额:",-1)),Ts={class:"amount-row total-amount"},Ds=o(()=>t("span",null,"实付金额:",-1)),Ps={key:2,class:"detail-section"},Ls=o(()=>t("h3",null,"备注信息",-1)),Bs={class:"note-content"},Es=lt({name:"myOrder"}),zs=Object.assign(Es,{setup(V){const{proxy:Fs}=nt(),T=ct(),D=it().id,U=_([]),k=_(-1),O=_(!1),g=_(!1),C=_(!1),b=_(null),P=_(null),n=_(null),I=_(""),S=_(""),F=[{label:"全部订单",value:-1},{label:"待支付",value:0},{label:"待确认",value:1},{label:"已确认",value:2},{label:"已完成",value:3},{label:"已取消",value:4},{label:"退款中",value:5},{label:"改签中",value:6}],L=dt(()=>k.value===-1?U.value:U.value.filter(s=>s.orderStatus===k.value));function p(){pt({pageNum:1,pageSize:1e4,userId:D}).then(s=>{U.value=s.rows}).catch(s=>{u.error("获取订单列表失败"),console.error(s)})}function B(s){return{0:"待支付",1:"待确认",2:"已确认",3:"已完成",4:"已取消",5:"退款中",6:"改签中"}[s]||"未知状态"}function E(s){return{0:"status-pending",1:"status-paid",2:"status-confirmed",3:"status-completed",4:"status-cancelled",5:"status-refunding",6:"status-rescheduling"}[s]||"status-unknown"}function j(s){return{wechat:"微信支付",alipay:"支付宝",bank:"银行转账",credit:"信用卡"}[s]||s}function q(s){k.value=s}function G(s){const l=s.orderId;Ct(l).then($=>{n.value=$.data,console.log(n.value),O.value=!0,P.value="订单详情"})}function z(s){b.value=s,I.value="",g.value=!0}function H(){if(!I.value.trim()){u.warning("请输入取消原因");return}kt({orderId:b.value.orderId,note:I.value}).then(()=>{b.value.orderStatus===0&&u.success("取消成功"),b.value.orderStatus===2&&u.success("订单已付款,现已为您发送退款请求。可在我的订单-退款中查看详细"),g.value=!1,p()}).catch(s=>{u.error("取消失败,请联系客服处理"),console.error(s)})}const x=_([]);function J(s){b.value=s,S.value="",St(s.productId).then(l=>{x.value=l.data}),C.value=!0}function K(){if(!S.value.trim()){u.warning("请输入改签日期及其原因");return}gt({orderId:b.value.orderId,note:S.value}).then(()=>{u.success("改签申请已提交,可在我的订单-改签中查看"),C.value=!1,p()}).catch(s=>{u.error("改签申请失败"),console.error(s)})}function Q(s){T.push({path:"/payment",query:{orderId:s.orderId,paymentAmount:s.paymentAmount}})}function W(s){mt({orderId:s.orderId}).then(()=>{u.success("订单已确认"),p()}).catch(l=>{u.error("确认失败"),console.error(l)})}function X(s){ft({orderId:s.orderId}).then(()=>{u.success("订单已标记为完成"),p()}).catch(l=>{u.error("操作失败"),console.error(l)})}function Y(s){T.push({path:"/comment",query:{userId:D,productId:s.productId,orderId:s.orderId}})}function Z(s){yt({orderId:s.orderId}).then(()=>{u.success("已取消改签"),p()}).catch(l=>{u.error("取消失败"),console.error(l)})}function tt(s){bt({orderId:s.orderId}).then(()=>{u.success("已取消退款"),p()}).catch(l=>{u.error("取消失败"),console.error(l)})}ut(()=>{p(),et()}),rt(k,()=>{p()});const A=_([]);function et(){It({pageNum:1,pageSize:1e4}).then(s=>{A.value=s.rows})}return(s,l)=>{const $=M("el-input"),w=M("el-button"),N=M("el-dialog"),st=M("el-tag");return c(),i("div",wt,[Vt,t("div",Ot,[(c(),i(m,null,y(F,e=>t("button",{key:e.value,onClick:d=>q(e.value),class:R({active:k.value===e.value})},a(e.label),11,xt)),64))]),t("div",$t,[L.value.length===0?(c(),i("div",Mt,Nt)):r("",!0),(c(!0),i(m,null,y(L.value,e=>(c(),i("div",{key:e.orderId,class:"order-card"},[t("div",Rt,[t("div",Tt,"订单号: "+a(e.orderId),1),t("div",{class:R(["order-status",E(e.orderStatus)])},a(B(e.orderStatus)),3)]),t("div",Dt,[t("div",Pt,[t("div",Lt,[f("产品名称: "),(c(!0),i(m,null,y(A.value,d=>(c(),i("span",{key:d.productId},[d.productId===e.productId?(c(),i("span",Bt,a(d.title),1)):r("",!0)]))),128))]),t("div",Et,"出发日期: "+a(e.departureDate),1),t("div",zt," 出行人: "+a(e.adultCount)+"成人 "+a(e.childCount)+"儿童 ",1)]),t("div",Ft,[t("div",jt,"联系人: "+a(e.contactName),1),t("div",qt,"电话: "+a(e.contactPhone),1)])]),t("div",Gt,[t("div",Ht,[Jt,t("span",null,"¥"+a(e.totalAmount),1)]),t("div",Kt,[Qt,t("span",null,"-¥"+a(e.discountAmount),1)]),t("div",Wt,[Xt,t("span",null,"¥"+a(e.paymentAmount),1)])]),t("div",Yt,[t("button",{class:"action-btn detail-btn",onClick:d=>G(e)}," 查看详情 ",8,Zt),e.orderStatus===0?(c(),i(m,{key:0},[t("button",{class:"action-btn pay-btn",onClick:d=>Q(e)},"去支付",8,te),t("button",{class:"action-btn cancel-btn",onClick:d=>z(e)},"取消订单",8,ee)],64)):r("",!0),e.orderStatus===1?(c(),i("button",{key:1,class:"action-btn confirm-btn",onClick:d=>W(e)},"确认订单",8,se)):r("",!0),e.orderStatus===2?(c(),i(m,{key:2},[t("button",{class:"action-btn change-btn",onClick:d=>J(e)},"改签",8,ae),t("button",{class:"action-btn cancel-btn",onClick:d=>z(e)},"取消订单",8,oe),t("button",{class:"action-btn complete-btn",onClick:d=>X(e)},"订单完成",8,le)],64)):r("",!0),e.orderStatus===3?(c(),i("button",{key:3,class:"action-btn comment-btn",onClick:d=>Y(e)},"去评价",8,ne)):r("",!0),e.orderStatus===5?(c(),i("button",{key:4,class:"action-btn cancel-btn",onClick:d=>tt(e)},"取消退款",8,ce)):r("",!0),e.orderStatus===6?(c(),i("button",{key:5,class:"action-btn cancel-btn",onClick:d=>Z(e)},"取消改签",8,ie)):r("",!0)])]))),128))]),h(N,{title:"取消原因",modelValue:g.value,"onUpdate:modelValue":l[2]||(l[2]=e=>g.value=e),width:"40%"},{footer:v(()=>[h(w,{onClick:l[1]||(l[1]=e=>g.value=!1)},{default:v(()=>[f("取消")]),_:1}),h(w,{type:"primary",onClick:H},{default:v(()=>[f("确认取消")]),_:1})]),default:v(()=>[h($,{type:"textarea",modelValue:I.value,"onUpdate:modelValue":l[0]||(l[0]=e=>I.value=e),placeholder:"请输入取消原因",rows:"4"},null,8,["modelValue"])]),_:1},8,["modelValue"]),h(N,{title:"改签日期选择",modelValue:C.value,"onUpdate:modelValue":l[5]||(l[5]=e=>C.value=e),width:"40%"},{footer:v(()=>[h(w,{onClick:l[4]||(l[4]=e=>C.value=!1)},{default:v(()=>[f("取消")]),_:1}),h(w,{type:"primary",onClick:K},{default:v(()=>[f("确认改签")]),_:1})]),default:v(()=>[x.value&&x.value.length>0?(c(),i("div",de,[ue,t("div",re,[(c(!0),i(m,null,y(x.value,(e,d)=>(c(),_t(st,{key:d,type:"success",class:"departure-date-tag"},{default:v(()=>[f(a(e),1)]),_:2},1024))),128))])])):r("",!0),h($,{type:"textarea",modelValue:S.value,"onUpdate:modelValue":l[3]||(l[3]=e=>S.value=e),placeholder:"请输入想要改签的日期以及改签原因",rows:"4",style:{"margin-top":"15px"}},null,8,["modelValue"])]),_:1},8,["modelValue"]),h(N,{title:P.value,modelValue:O.value,"onUpdate:modelValue":l[7]||(l[7]=e=>O.value=e),width:"800px",class:"order-detail-dialog"},{footer:v(()=>[h(w,{onClick:l[6]||(l[6]=e=>O.value=!1)},{default:v(()=>[f("关闭")]),_:1})]),default:v(()=>[n.value?(c(),i("div",_e,[t("div",ve,[he,t("div",pe,[t("div",me,[fe,t("span",be,a(n.value.orderId),1)]),t("div",ye,[ke,t("span",ge,a(n.value.createdAt),1)]),t("div",Ce,[Ie,t("span",{class:R(["value",E(n.value.orderStatus)])},a(B(n.value.orderStatus)),3)]),t("div",Se,[we,t("span",Ve,a(n.value.departureDate),1)])])]),t("div",Oe,[xe,t("div",$e,[t("div",Me,[Ue,t("span",Ae,[(c(!0),i(m,null,y(A.value,e=>(c(),i("span",{key:e.productId},[e.productId===n.value.productId?(c(),i("span",Ne,a(e.title),1)):r("",!0)]))),128))])]),t("div",Re,[Te,t("span",De,a(n.value.adultCount),1)]),t("div",Pe,[Le,t("span",Be,a(n.value.childCount),1)])])]),t("div",Ee,[ze,t("div",Fe,[t("div",je,[qe,t("span",Ge,a(n.value.contactName),1)]),t("div",He,[Je,t("span",Ke,a(n.value.contactPhone),1)]),t("div",Qe,[We,t("span",Xe,a(n.value.contactEmail),1)])])]),n.value.orderTravelers&&n.value.orderTravelers.length>0?(c(),i("div",Ye,[Ze,t("div",ts,[(c(!0),i(m,null,y(n.value.orderTravelers,(e,d)=>(c(),i("div",{class:"traveler-item",key:e.id},[t("div",es," 出行人 "+a(d+1)+" ("+a(e.isAdult===1?"成人":"儿童")+") ",1),t("div",ss,[t("div",as,[os,t("span",ls,a(e.realName),1)]),t("div",ns,[cs,t("span",is,a(e.gender===1?"男":"女"),1)]),t("div",ds,[us,t("span",rs,a(e.birthdate),1)]),t("div",_s,[vs,t("span",hs,a(e.passportNumber),1)]),t("div",ps,[ms,t("span",fs,a(e.passportExpiry),1)])])]))),128))])])):r("",!0),n.value.payments?(c(),i("div",bs,[ys,t("div",ks,[t("div",gs,[Cs,t("span",Is,a(j(n.value.payments.paymentMethod)),1)]),t("div",Ss,[ws,t("span",Vs,a(n.value.payments.paymentStatus===1?"已支付":"未支付"),1)]),t("div",Os,[xs,t("span",$s,a(n.value.payments.paidAt),1)]),t("div",Ms,[t("div",Us,[As,t("span",null,"¥"+a(n.value.totalAmount),1)]),t("div",Ns,[Rs,t("span",null,"-¥"+a(n.value.discountAmount),1)]),t("div",Ts,[Ds,t("span",null,"¥"+a(n.value.paymentAmount),1)])])])])):r("",!0),n.value.note?(c(),i("div",Ps,[Ls,t("div",Bs,a(n.value.note),1)])):r("",!0)])):r("",!0)]),_:1},8,["title","modelValue"])])}}}),Ws=ot(zs,[["__scopeId","data-v-74102741"]]);export{Ws as default};
