import{_ as we,C as Ce,d as Ae,r as h,O as Se,T as De,e as i,R as G,c as H,o as I,H as C,h as e,S as J,B as l,i as a,l as W,F as ke,D as Ne,j as D,m as v,P as E,f as o,A as d,a1 as Ue,G as Oe,s as xe,t as Pe}from"./index-Lq3EucIc.js";import{l as qe,g as Te,u as Me,a as Re}from"./manageOrders-DjJZIfBR.js";import{l as Ee}from"./page-lV5IMbY_.js";import{l as Fe}from"./products-CBA54OiK.js";const c=N=>(xe("data-v-5ad63d10"),N=N(),Pe(),N),$e={class:"app-container"},Be=c(()=>o("span",null,"出发日期",-1)),Le={class:"dialog-footer"},ze={class:"order-header"},Ye={class:"order-title"},Ke={class:"order-meta"},Qe={class:"info-item"},je=c(()=>o("span",{class:"info-label"},"用户ID:",-1)),Ge={class:"info-value"},He={class:"info-item"},Je=c(()=>o("span",{class:"info-label"},"产品名称:",-1)),We={class:"info-value"},Xe={class:"info-item"},Ze=c(()=>o("span",{class:"info-label"},"出发日期:",-1)),et={class:"info-value"},tt={class:"info-item"},lt=c(()=>o("span",{class:"info-label"},"联系人:",-1)),at={class:"info-value"},ot={class:"info-item"},nt=c(()=>o("span",{class:"info-label"},"联系电话:",-1)),st={class:"info-value"},dt={class:"info-item"},rt=c(()=>o("span",{class:"info-label"},"联系邮箱:",-1)),ut={class:"info-value"},it={class:"info-item"},pt=c(()=>o("span",{class:"info-label"},"成人数:",-1)),ct={class:"info-value"},mt={class:"info-item"},_t=c(()=>o("span",{class:"info-label"},"儿童数:",-1)),ft={class:"info-value"},gt={class:"price-section"},ht={class:"info-item"},vt=c(()=>o("span",{class:"info-label"},"订单总额:",-1)),bt={class:"info-value price"},Vt={class:"info-item"},yt=c(()=>o("span",{class:"info-label"},"优惠金额:",-1)),It={class:"info-value price discount"},wt={class:"info-item"},Ct=c(()=>o("span",{class:"info-label"},"支付金额:",-1)),At={class:"info-value price final"},St={class:"info-item"},Dt=c(()=>o("span",{class:"info-label"},"支付方式:",-1)),kt={class:"info-value"},Nt={class:"info-item"},Ut=c(()=>o("span",{class:"info-label"},"支付时间:",-1)),Ot={class:"info-value"},xt={class:"travelers-section"},Pt=c(()=>o("h4",null,"出行人信息",-1)),qt={class:"note-section"},Tt={class:"info-item"},Mt=c(()=>o("span",{class:"info-label"},"订单备注:",-1)),Rt={class:"info-value"},Et={class:"dialog-footer"},Ft=Ce({name:"ManageOrders"}),$t=Object.assign(Ft,{setup(N){const{proxy:V}=Ae(),{order_status:q}=V.useDict("order_status"),F=h([]),w=h(!1),T=h(!0),U=h(!0),$=h([]),X=h(!0),Z=h(!0),M=h(0),B=h(""),k=h(!1),L=h(""),r=h({}),ee=Se({form:{},queryParams:{pageNum:1,pageSize:10,userId:null,productId:null,orderId:null,departureDate:null,orderStatus:null,contactName:null},rules:{userId:[{required:!0,message:"用户ID不能为空",trigger:"blur"}],productId:[{required:!0,message:"产品ID不能为空",trigger:"blur"}],departureDate:[{required:!0,message:"出发日期不能为空",trigger:"blur"}],totalAmount:[{required:!0,message:"订单总额不能为空",trigger:"blur"}],paymentAmount:[{required:!0,message:"支付金额不能为空",trigger:"blur"}],contactName:[{required:!0,message:"联系人姓名不能为空",trigger:"blur"}],contactPhone:[{required:!0,message:"联系人电话不能为空",trigger:"blur"}]}}),{queryParams:f,form:s,rules:te}=De(ee);function A(){T.value=!0,qe(f.value).then(u=>{F.value=u.rows,M.value=u.total,T.value=!1})}function le(u){const n=u.orderId||$.value;Te(n).then(m=>{r.value=m.data,k.value=!0,L.value="订单详情"})}function ae(u){switch(u){case"0":return"pending";case"1":return"paid";case"2":return"completed";case"3":return"cancelled";default:return""}}function oe(){w.value=!1,z()}function z(){s.value={orderId:null,userId:null,productId:null,departureDate:null,adultCount:null,childCount:null,totalAmount:null,discountAmount:null,paymentAmount:null,orderStatus:null,contactName:null,contactPhone:null,contactEmail:null,note:null,createdAt:null,paidAt:null,cancelledAt:null},V.resetForm("manageOrdersRef")}function O(){f.value.pageNum=1,A()}function ne(){V.resetForm("queryRef"),O()}function se(u){$.value=u.map(n=>n.orderId),X.value=u.length!=1,Z.value=!u.length}function de(){z(),w.value=!0,B.value="添加订单管理"}function re(){V.$refs.manageOrdersRef.validate(u=>{u&&(s.value.orderId!=null?Me(s.value).then(n=>{V.$modal.msgSuccess("修改成功"),w.value=!1,A()}):Re(s.value).then(n=>{V.$modal.msgSuccess("新增成功"),w.value=!1,A()}))})}function ue(){V.download("manage/manageOrders/export",{...f.value},`manageOrders_${new Date().getTime()}.xlsx`)}const R=h([]);function ie(){Fe(Ee).then(u=>{R.value=u.rows})}function pe(u){const n=u.orderId;V.$router.push({path:"/feedback/reviewsManage",query:{orderId:n}})}return A(),ie(),(u,n)=>{const m=i("el-input"),p=i("el-form-item"),ce=i("el-option"),me=i("el-select"),b=i("el-button"),Y=i("el-form"),_=i("el-col"),_e=i("right-toolbar"),y=i("el-row"),g=i("el-table-column"),fe=i("el-icon"),ge=i("el-tooltip"),K=i("dict-tag"),Q=i("el-table"),he=i("pagination"),ve=i("el-date-picker"),j=i("el-dialog"),x=i("el-divider"),be=i("el-tag"),Ve=i("el-card"),P=G("hasPermi"),ye=G("loading");return I(),H("div",$e,[C(e(Y,{model:l(f),ref:"queryRef",inline:!0,"label-width":"68px"},{default:a(()=>[e(p,{label:"订单号",prop:"orderId"},{default:a(()=>[e(m,{modelValue:l(f).orderId,"onUpdate:modelValue":n[0]||(n[0]=t=>l(f).orderId=t),placeholder:"请输入订单号",clearable:"",onKeyup:W(O,["enter"])},null,8,["modelValue"])]),_:1}),e(p,{label:"订单状态",prop:"orderStatus"},{default:a(()=>[e(me,{modelValue:l(f).orderStatus,"onUpdate:modelValue":n[1]||(n[1]=t=>l(f).orderStatus=t),placeholder:"请选择订单状态",clearable:""},{default:a(()=>[(I(!0),H(ke,null,Ne(l(q),t=>(I(),D(ce,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"联系人",prop:"contactName"},{default:a(()=>[e(m,{modelValue:l(f).contactName,"onUpdate:modelValue":n[2]||(n[2]=t=>l(f).contactName=t),placeholder:"请输入联系人",clearable:"",onKeyup:W(O,["enter"])},null,8,["modelValue"])]),_:1}),e(p,null,{default:a(()=>[e(b,{type:"primary",icon:"Search",onClick:O},{default:a(()=>[v("搜索")]),_:1}),e(b,{icon:"Refresh",onClick:ne},{default:a(()=>[v("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[J,l(U)]]),e(y,{gutter:10,class:"mb8"},{default:a(()=>[e(_,{span:1.5},{default:a(()=>[C((I(),D(b,{type:"primary",plain:"",icon:"Plus",onClick:de},{default:a(()=>[v("新增")]),_:1})),[[P,["manage:manageOrders:add"]]])]),_:1}),e(_,{span:1.5},{default:a(()=>[C((I(),D(b,{type:"warning",plain:"",icon:"Download",onClick:ue},{default:a(()=>[v("导出")]),_:1})),[[P,["manage:manageOrders:export"]]])]),_:1}),e(_e,{showSearch:l(U),"onUpdate:showSearch":n[3]||(n[3]=t=>E(U)?U.value=t:null),onQueryTable:A},null,8,["showSearch"])]),_:1}),C((I(),D(Q,{data:l(F),onSelectionChange:se},{default:a(()=>[e(g,{type:"selection",width:"55",align:"center"}),e(g,{label:"订单号",align:"center",prop:"orderId"}),e(g,{label:"用户编号",align:"center",prop:"userId"}),e(g,{label:"产品名称",align:"center",prop:"productId"},{default:a(t=>{var S;return[o("span",null,d(((S=l(R).find(Ie=>Ie.productId===t.row.productId))==null?void 0:S.title)||t.row.productId),1)]}),_:1}),e(g,{label:"出发日期",align:"center",prop:"departureDate",width:"180"},{header:a(()=>[Be,e(ge,{content:"若非旅行服务出发日期代表但不限于使用日期，签发日期等",placement:"top"},{default:a(()=>[e(fe,{style:{"margin-left":"5px",color:"#409EFF",cursor:"pointer"}},{default:a(()=>[e(l(Ue))]),_:1})]),_:1})]),default:a(t=>[o("span",null,d(u.parseTime(t.row.departureDate,"{y}-{m}-{d}")),1)]),_:1}),e(g,{label:"订单状态",align:"center",prop:"orderStatus"},{default:a(t=>[e(K,{options:l(q),value:t.row.orderStatus},null,8,["options","value"])]),_:1}),e(g,{label:"创建时间",align:"center",prop:"createdAt",width:"180"},{default:a(t=>[o("span",null,d(u.parseTime(t.row.createdAt,"{y}-{m}-{d}")),1)]),_:1}),e(g,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:a(t=>[C((I(),D(b,{link:"",type:"primary",icon:"View",onClick:S=>le(t.row)},{default:a(()=>[v("查看订单详细")]),_:2},1032,["onClick"])),[[P,["manage:manageOrders:query"]]]),C((I(),D(b,{link:"",type:"primary",icon:"Stamp",onClick:S=>pe(t.row)},{default:a(()=>[v("查看订单评价")]),_:2},1032,["onClick"])),[[P,["manage:manageOrders:query"]]])]),_:1})]),_:1},8,["data"])),[[ye,l(T)]]),C(e(he,{total:l(M),page:l(f).pageNum,"onUpdate:page":n[4]||(n[4]=t=>l(f).pageNum=t),limit:l(f).pageSize,"onUpdate:limit":n[5]||(n[5]=t=>l(f).pageSize=t),onPagination:A},null,8,["total","page","limit"]),[[J,l(M)>0]]),e(j,{title:l(B),modelValue:l(w),"onUpdate:modelValue":n[18]||(n[18]=t=>E(w)?w.value=t:null),width:"500px","append-to-body":""},{footer:a(()=>[o("div",Le,[e(b,{type:"primary",onClick:re},{default:a(()=>[v("确 定")]),_:1}),e(b,{onClick:oe},{default:a(()=>[v("取 消")]),_:1})])]),default:a(()=>[e(Y,{ref:"manageOrdersRef",model:l(s),rules:l(te),"label-width":"80px"},{default:a(()=>[e(p,{label:"用户ID",prop:"userId"},{default:a(()=>[e(m,{modelValue:l(s).userId,"onUpdate:modelValue":n[6]||(n[6]=t=>l(s).userId=t),placeholder:"请输入用户ID"},null,8,["modelValue"])]),_:1}),e(p,{label:"产品ID",prop:"productId"},{default:a(()=>[e(m,{modelValue:l(s).productId,"onUpdate:modelValue":n[7]||(n[7]=t=>l(s).productId=t),placeholder:"请输入产品ID"},null,8,["modelValue"])]),_:1}),e(p,{label:"出发日期",prop:"departureDate"},{default:a(()=>[e(ve,{clearable:"",modelValue:l(s).departureDate,"onUpdate:modelValue":n[8]||(n[8]=t=>l(s).departureDate=t),type:"date","value-format":"YYYY-MM-DD",placeholder:"请选择出发日期"},null,8,["modelValue"])]),_:1}),e(p,{label:"成人数",prop:"adultCount"},{default:a(()=>[e(m,{modelValue:l(s).adultCount,"onUpdate:modelValue":n[9]||(n[9]=t=>l(s).adultCount=t),placeholder:"请输入成人数"},null,8,["modelValue"])]),_:1}),e(p,{label:"儿童数",prop:"childCount"},{default:a(()=>[e(m,{modelValue:l(s).childCount,"onUpdate:modelValue":n[10]||(n[10]=t=>l(s).childCount=t),placeholder:"请输入儿童数"},null,8,["modelValue"])]),_:1}),e(p,{label:"订单总额",prop:"totalAmount"},{default:a(()=>[e(m,{modelValue:l(s).totalAmount,"onUpdate:modelValue":n[11]||(n[11]=t=>l(s).totalAmount=t),placeholder:"请输入订单总额"},null,8,["modelValue"])]),_:1}),e(p,{label:"优惠金额",prop:"discountAmount"},{default:a(()=>[e(m,{modelValue:l(s).discountAmount,"onUpdate:modelValue":n[12]||(n[12]=t=>l(s).discountAmount=t),placeholder:"请输入优惠金额"},null,8,["modelValue"])]),_:1}),e(p,{label:"支付金额",prop:"paymentAmount"},{default:a(()=>[e(m,{modelValue:l(s).paymentAmount,"onUpdate:modelValue":n[13]||(n[13]=t=>l(s).paymentAmount=t),placeholder:"请输入支付金额"},null,8,["modelValue"])]),_:1}),e(p,{label:"联系人姓名",prop:"contactName"},{default:a(()=>[e(m,{modelValue:l(s).contactName,"onUpdate:modelValue":n[14]||(n[14]=t=>l(s).contactName=t),placeholder:"请输入联系人姓名"},null,8,["modelValue"])]),_:1}),e(p,{label:"联系人电话",prop:"contactPhone"},{default:a(()=>[e(m,{modelValue:l(s).contactPhone,"onUpdate:modelValue":n[15]||(n[15]=t=>l(s).contactPhone=t),placeholder:"请输入联系人电话"},null,8,["modelValue"])]),_:1}),e(p,{label:"联系人邮箱",prop:"contactEmail"},{default:a(()=>[e(m,{modelValue:l(s).contactEmail,"onUpdate:modelValue":n[16]||(n[16]=t=>l(s).contactEmail=t),placeholder:"请输入联系人邮箱"},null,8,["modelValue"])]),_:1}),e(p,{label:"订单备注",prop:"note"},{default:a(()=>[e(m,{modelValue:l(s).note,"onUpdate:modelValue":n[17]||(n[17]=t=>l(s).note=t),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),e(j,{title:l(L),modelValue:l(k),"onUpdate:modelValue":n[20]||(n[20]=t=>E(k)?k.value=t:null),width:"600px","append-to-body":""},{footer:a(()=>[o("div",Et,[e(b,{onClick:n[19]||(n[19]=t=>k.value=!1)},{default:a(()=>[v("关 闭")]),_:1})])]),default:a(()=>[e(Ve,{class:Oe(["order-detail-card",ae(l(r).orderStatus)])},{default:a(()=>[o("div",ze,[o("div",Ye,[o("h3",null,"订单详情 #"+d(l(r).orderId),1),e(K,{options:l(q),value:l(r).orderStatus,style:{"margin-left":"15px"}},null,8,["options","value"])]),o("div",Ke,[o("span",null,"创建时间: "+d(u.parseTime(l(r).createdAt,"{y}-{m}-{d} {h}:{i}:{s}")),1)])]),e(x),e(y,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>[o("div",Qe,[je,o("span",Ge,d(l(r).userId),1)])]),_:1}),e(_,{span:12},{default:a(()=>{var t;return[o("div",He,[Je,o("span",We,d(((t=l(R).find(S=>S.productId===l(r).productId))==null?void 0:t.title)||l(r).productId),1)])]}),_:1})]),_:1}),e(y,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>[o("div",Xe,[Ze,o("span",et,d(u.parseTime(l(r).departureDate,"{y}-{m}-{d}")),1)])]),_:1}),e(_,{span:12},{default:a(()=>[o("div",tt,[lt,o("span",at,d(l(r).contactName),1)])]),_:1})]),_:1}),e(y,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>[o("div",ot,[nt,o("span",st,d(l(r).contactPhone),1)])]),_:1}),e(_,{span:12},{default:a(()=>[o("div",dt,[rt,o("span",ut,d(l(r).contactEmail||"-"),1)])]),_:1})]),_:1}),e(y,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>[o("div",it,[pt,o("span",ct,d(l(r).adultCount||0),1)])]),_:1}),e(_,{span:12},{default:a(()=>[o("div",mt,[_t,o("span",ft,d(l(r).childCount||0),1)])]),_:1})]),_:1}),e(x),o("div",gt,[e(y,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>[o("div",ht,[vt,o("span",bt,"¥"+d(l(r).totalAmount),1)])]),_:1}),e(_,{span:12},{default:a(()=>[o("div",Vt,[yt,o("span",It,"-¥"+d(l(r).discountAmount||0),1)])]),_:1})]),_:1}),e(y,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>[o("div",wt,[Ct,o("span",At,"¥"+d(l(r).paymentAmount),1)])]),_:1}),e(_,{span:12},{default:a(()=>{var t;return[o("div",St,[Dt,o("span",kt,d(((t=l(r).payments)==null?void 0:t.paymentMethod)||"-"),1)])]}),_:1})]),_:1}),e(y,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>{var t;return[o("div",Nt,[Ut,o("span",Ot,d((t=l(r).payments)!=null&&t.paidAt?u.parseTime(l(r).payments.paidAt,"{y}-{m}-{d} {h}:{i}:{s}"):"-"),1)])]}),_:1})]),_:1})]),e(x),o("div",xt,[Pt,e(Q,{data:l(r).orderTravelers,style:{width:"100%","margin-top":"15px"},border:""},{default:a(()=>[e(g,{label:"姓名",prop:"realName",align:"center"}),e(g,{label:"类型",align:"center"},{default:a(t=>[e(be,{type:t.row.isAdult===1?"primary":"success"},{default:a(()=>[v(d(t.row.isAdult===1?"成人":"儿童"),1)]),_:2},1032,["type"])]),_:1}),e(g,{label:"性别",align:"center"},{default:a(t=>[o("span",null,d(t.row.gender===1?"男":"女"),1)]),_:1}),e(g,{label:"出生日期",prop:"birthdate",align:"center"},{default:a(t=>[o("span",null,d(t.row.birthdate||"-"),1)]),_:1}),e(g,{label:"护照号",prop:"passportNumber",align:"center"},{default:a(t=>[o("span",null,d(t.row.passportNumber||"-"),1)]),_:1})]),_:1},8,["data"])]),e(x),o("div",qt,[o("div",Tt,[Mt,o("span",Rt,d(l(r).note||"无备注"),1)])])]),_:1},8,["class"])]),_:1},8,["title","modelValue"])])}}}),Kt=we($t,[["__scopeId","data-v-5ad63d10"]]);export{Kt as default};
