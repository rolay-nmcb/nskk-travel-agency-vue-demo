import{_ as w,b as T,d as U,u as x,r as h,y as z,v as M,c as o,f as e,A as r,m as A,F as p,D as m,L as B,G as C,s as V,t as F,o as a,k as H}from"./index-CqU5sET7.js";import{g as E,l as G}from"./travelNotesUser-B8bKppJE.js";import{l as R}from"./userManage-B6SVjGn0.js";const d=u=>(V("data-v-1a767daf"),u=u(),F(),u),X={class:"note-detail-container"},j={key:0,class:"loading-container"},q=d(()=>e("div",{class:"spinner"},null,-1)),J=d(()=>e("p",null,"加载中...",-1)),K=[q,J],O={key:1,class:"note-content"},P={class:"note-header"},Q={class:"note-title"},W={class:"note-meta"},Y={class:"publish-date"},Z={class:"user-id"},ee={key:0},se={class:"view-count"},te={class:"carousel-container"},oe=["src","alt"],ae={class:"carousel-indicators"},ne=["onClick"],le={class:"note-body"},ce={class:"content-wrapper"},ie=["innerHTML"],re={class:"note-actions"},ue=d(()=>e("i",{class:"like-icon"},"❤️",-1)),de={class:"like-count"},_e=d(()=>e("button",{class:"share-btn"},[e("i",{class:"share-icon"},"📤"),e("span",null,"分享")],-1)),ve={__name:"detail",setup(u){const k=T().id,{proxy:_}=U(),f=x().params.noteId,s=h(null),g=h([]),l=h(0),c=z(()=>{var t;return(t=s.value)!=null&&t.coverImage?s.value.coverImage.split(","):[]});M(()=>{y(f,k),S(),D()});function y(t,v){E(t,v).then(n=>{s.value=n.data})}function S(){R({pageNum:1,pageSize:1e4}).then(t=>{g.value=t.rows})}function L(t){return t?new Date(t).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}):""}function I(){l.value=(l.value+1)%c.value.length}function b(){l.value=(l.value-1+c.value.length)%c.value.length}function N(t){l.value=t}function D(){setInterval(()=>{c.value.length>1&&I()},5e3)}function $(){G({noteId:f,userId:k,likeCount:s.value.likeCount}).then(t=>{t.code===200&&(s.value.isLiked===1?(_.$message.success("取消点赞成功"),s.value.likeCount--,s.value.isLiked=0):(_.$message.success("点赞成功"),s.value.likeCount++,s.value.isLiked=1))}).catch(t=>{_.$message.error("点赞失败，请重试"),console.error("点赞失败:",t)})}return(t,v)=>(a(),o("div",X,[s.value?(a(),o("div",O,[e("div",P,[e("h1",Q,r(s.value.title),1),e("div",W,[e("span",Y,r(L(s.value.createdAt)),1),e("span",Z,[A("作者: "),(a(!0),o(p,null,m(g.value,n=>(a(),o("span",{key:n.userId},[n.userId===s.value.userId?(a(),o("span",ee,r(n.nickName),1)):H("",!0)]))),128))]),e("span",se,"👁️ "+r(s.value.viewCount)+" 浏览",1)])]),e("div",te,[e("div",{class:"carousel",style:B({transform:`translateX(-${l.value*100}%)`})},[(a(!0),o(p,null,m(c.value,(n,i)=>(a(),o("img",{key:i,src:n,alt:`${s.value.title} - 图片${i+1}`,class:"carousel-img"},null,8,oe))),128))],4),e("button",{class:"carousel-btn prev",onClick:b},"←"),e("button",{class:"carousel-btn next",onClick:I},"→"),e("div",ae,[(a(!0),o(p,null,m(c.value,(n,i)=>(a(),o("span",{key:i,class:C({active:l.value===i}),onClick:me=>N(i)},null,10,ne))),128))])]),e("div",le,[e("div",ce,[e("div",{innerHTML:s.value.content},null,8,ie)])]),e("div",re,[e("button",{class:C(["like-btn",{liked:s.value.isLiked===1}]),onClick:$},[ue,e("span",de,r(s.value.likeCount),1)],2),_e])])):(a(),o("div",j,K))]))}},Ie=w(ve,[["__scopeId","data-v-1a767daf"]]);export{Ie as default};
